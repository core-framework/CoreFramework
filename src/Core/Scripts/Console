#!/usr/bin/env php
<?php

namespace Core\Scripts;

use Core\CacheSystem\cache;

define('DS', DIRECTORY_SEPARATOR);
chdir(__DIR__ . DS . ".." . DS . ".." . DS . ".." . DS);
$vendor = getcwd() . DS . "vendor";
if (is_dir($vendor)) {
    $rootDir = getcwd();
    define('_ROOT', $rootDir);
    define('_isPROJECT', true);
} else {
    chdir(".." . DS . ".." . DS . ".." . DS);
    $vendor = getcwd() . DS . "vendor";
    if ($vendor) {
        $rootDir = getcwd();
        define('_ROOT', $rootDir);
        define('_isPROJECT', false);
    } else {
        echo "ERROR: root path not found";
    }
}


$loader = require_once _ROOT . DS . "vendor" . DS . "autoload.php";

$cache = new cache();
$corecmd = $cache->getCache('corecmd_cache');

if (!empty($corecmd) && $corecmd !== false) {
    /** @var TYPE_NAME $argv */
    /** @var TYPE_NAME $argc */
    $cmd = $corecmd->__construct($argv, $argc);
} else {
    /** @var TYPE_NAME $argv */
    /** @var TYPE_NAME $argc */
    $cmd = new corecmd($argv, $argc);
    $cache->cacheContent("corecmd_cache", $cmd, 0);
}


